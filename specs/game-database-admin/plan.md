# Feature: Game Database Schema and Admin Dashboard - Implementation Plan

> **Generated by:** Task Decomposition skill
> **From spec:** specs/game-database-admin/spec.md
> **Created:** 2025-10-17

## Execution Summary

- **Total Tasks**: 15
- **Total Phases**: 7
- **Sequential Time**: 27.5h
- **Parallel Time**: 16h
- **Time Savings**: 11.5h (42%)

**Parallel Opportunities:**
- Phase 2: 2 tasks (1h saved)
- Phase 7: 7 tasks (9h saved)

---

## Phase 1: Foundation - Database & Dependencies

**Strategy**: Sequential
**Reason**: Database schema must exist before any code can reference it; tsx needed for seed script

### Task 1.1: Add Game Database Schema

**Files**:
- `prisma/schema.prisma`
- `prisma/migrations/XXXXXX_add_game_models/`

**Complexity**: M (3h)

**Dependencies**: None

**Description**:
Add all 7 game models (Event, Game, Category, Work, Person, Nomination, Pick) and 2 enums (GameStatus, WorkType) to Prisma schema following schema-rules.md conventions.

**Implementation Steps**:
1. Add GameStatus enum (SETUP, OPEN, LIVE, COMPLETED)
2. Add WorkType enum (FILM, TV_SHOW, ALBUM, SONG, PLAY, BOOK)
3. Add Event model with fields per spec (id, name, slug, description, eventDate, timestamps)
4. Add Game model with GameStatus enum and fields per spec
5. Add Category model with fields per spec (including isRevealed, points, winnerNominationId)
6. Add Work model with WorkType enum and fields per spec
7. Add Person model with fields per spec
8. Add Nomination model with optional workId/personId per spec
9. Add Pick model with composite unique constraint [gameId, userId, categoryId]
10. Add picks relation to User model
11. Add all foreign key indexes per spec
12. Run `pnpm prisma migrate dev --name add_game_models`
13. Run `pnpm prisma generate`
14. Verify migration with `pnpm prisma studio`

**Acceptance Criteria**:
- [ ] All 7 models present in schema.prisma
- [ ] Both enums defined with correct values
- [ ] All foreign keys have @@index directives
- [ ] Composite unique constraint on Pick model works
- [ ] Migration runs without errors
- [ ] Prisma Studio shows all new tables
- [ ] `pnpm prisma generate` completes successfully

**Mandatory Patterns** (BigNight.Party):
- Schema naming: PascalCase models, camelCase fields (@docs/constitutions/v1/schema-rules.md)
- Field organization: ID, required, optional, relations, timestamps
- All enums: UPPER_CASE values

**Quality Gates**:
```bash
pnpm prisma format
pnpm prisma validate
pnpm prisma migrate dev --name add_game_models
pnpm prisma generate
pnpm biome check --write prisma/schema.prisma
```

---

### Task 1.2: Install tsx Dependency

**Files**:
- `package.json`
- `pnpm-lock.yaml`

**Complexity**: S (0.5h)

**Dependencies**: None

**Description**:
Install tsx as dev dependency for running TypeScript seed script, and add db:seed script to package.json.

**Implementation Steps**:
1. Run `pnpm add -D tsx`
2. Add `"db:seed": "tsx prisma/seed.ts"` to package.json scripts
3. Verify installation with `pnpm tsx --version`

**Acceptance Criteria**:
- [ ] tsx appears in devDependencies
- [ ] pnpm-lock.yaml updated
- [ ] db:seed script present in package.json
- [ ] `pnpm tsx --version` works

**Mandatory Patterns** (BigNight.Party):
- Version pinning: Use `^` for dev dependencies (@docs/constitutions/v1/tech-stack.md)

**Quality Gates**:
```bash
pnpm biome check --write package.json
pnpm tsx --version
```

---

## Phase 2: Data Layer - Models & Schemas

**Strategy**: Parallel
**Reason**: Models and Schemas are independent and can be built simultaneously

### Task 2.1: Create Models Layer

**Files**:
- `src/lib/models/event.ts`
- `src/lib/models/game.ts`
- `src/lib/models/category.ts`
- `src/lib/models/work.ts`
- `src/lib/models/person.ts`
- `src/lib/models/nomination.ts`
- `src/lib/models/pick.ts`

**Complexity**: M (3h)

**Dependencies**: Task 1.1 (needs Prisma schema)

**Description**:
Create model layer files for all 7 entities with standard CRUD operations (create, findAll, findById, update, delete). Each model uses Prisma client and exports typed functions.

**Implementation Steps**:
1. Create `src/lib/models/event.ts` with create, findAll, findById, findBySlug, update, delete
2. Create `src/lib/models/game.ts` with create, findAll, findById, findByEventId, findByAccessCode, update, delete
3. Create `src/lib/models/category.ts` with create, findAll, findById, findByEventId, update, delete
4. Create `src/lib/models/work.ts` with create, findAll, findById, findByType, update, delete
5. Create `src/lib/models/person.ts` with create, findAll, findById, update, delete
6. Create `src/lib/models/nomination.ts` with create, findAll, findById, findByCategoryId (include Work/Person), update, delete
7. Create `src/lib/models/pick.ts` with create, findAll, findById, findByGameId, findByUserId, delete
8. Each model imports `prisma` from `@/lib/db/prisma`
9. Use Prisma types: `Prisma.EventCreateInput`, etc.
10. Include relations in find operations where needed

**Acceptance Criteria**:
- [ ] All 7 model files exist and export CRUD functions
- [ ] No Prisma imports outside models/ layer
- [ ] All functions properly typed with Prisma types
- [ ] nomination.ts includes Work/Person in findByCategoryId
- [ ] All files follow camelCase function naming
- [ ] TypeScript compiles without errors

**Mandatory Patterns** (BigNight.Party):
- Models layer: ONLY Prisma queries, no business logic (@docs/constitutions/v1/architecture.md)
- No `next/*` imports in models
- Use `Prisma` types from `@prisma/client`

**Quality Gates**:
```bash
pnpm check-types
pnpm biome check --write src/lib/models/
```

---

### Task 2.2: Create Validation Schemas

**Files**:
- `src/schemas/event-schema.ts`
- `src/schemas/game-schema.ts`
- `src/schemas/category-schema.ts`
- `src/schemas/work-schema.ts`
- `src/schemas/person-schema.ts`
- `src/schemas/nomination-schema.ts`

**Complexity**: M (2h)

**Dependencies**: Task 1.1 (references Prisma enums)

**Description**:
Create Zod validation schemas for all 6 entity types with create/update variants. Schemas validate all required fields, enums, and business rules.

**Implementation Steps**:
1. Create `event-schema.ts` with eventCreateSchema and eventUpdateSchema (validate slug format, date)
2. Create `game-schema.ts` with gameCreateSchema and gameUpdateSchema (validate GameStatus enum, accessCode format)
3. Create `category-schema.ts` with categoryCreateSchema and categoryUpdateSchema (validate points > 0, order >= 0)
4. Create `work-schema.ts` with workCreateSchema and workUpdateSchema (validate WorkType enum, year range)
5. Create `person-schema.ts` with personCreateSchema and personUpdateSchema
6. Create `nomination-schema.ts` with nominationCreateSchema and nominationUpdateSchema (validate at least one of workId or personId exists)
7. Use `z.nativeEnum()` for GameStatus and WorkType
8. Add `.refine()` to nomination schema for workId/personId validation
9. Export inferred types: `export type EventCreateInput = z.infer<typeof eventCreateSchema>`

**Acceptance Criteria**:
- [ ] All 6 schema files exist with create/update variants
- [ ] GameStatus enum validated with z.nativeEnum()
- [ ] WorkType enum validated with z.nativeEnum()
- [ ] Nomination schema enforces workId or personId requirement
- [ ] All schemas export inferred TypeScript types
- [ ] TypeScript compiles without errors

**Mandatory Patterns** (BigNight.Party):
- Validation: Use Zod for all inputs (@docs/constitutions/v1/patterns.md)
- Enums: Use z.nativeEnum() for Prisma enums
- Export types: `export type X = z.infer<typeof schema>`

**Quality Gates**:
```bash
pnpm check-types
pnpm biome check --write src/schemas/
```

---

## Phase 3: Business Logic - Services

**Strategy**: Sequential
**Reason**: Services depend on models being complete

### Task 3.1: Create Services Layer

**Files**:
- `src/lib/services/event-service.ts`
- `src/lib/services/game-service.ts`
- `src/lib/services/admin-service.ts`

**Complexity**: M (2h)

**Dependencies**: Task 2.1 (imports models)

**Description**:
Create service layer for business logic. Services orchestrate multiple model calls, handle validation, and manage complex operations like cascading deletes.

**Implementation Steps**:
1. Create `event-service.ts` with createEvent, updateEvent, deleteEvent (cascades to categories/games)
2. Create `game-service.ts` with createGame, updateGame, deleteGame, updateGameStatus (uses ts-pattern)
3. Create `admin-service.ts` with validateAdminAccess, getAdminDashboardStats
4. Import models: `import * as eventModel from '@/lib/models/event'`
5. Use ts-pattern for GameStatus state transitions in game-service.ts
6. Add `.exhaustive()` to all ts-pattern matches
7. Handle cascading deletes in event/game services
8. No Prisma imports (only model layer)

**Acceptance Criteria**:
- [ ] All 3 service files exist
- [ ] No `@prisma/client` imports in services
- [ ] game-service.ts uses ts-pattern with .exhaustive() for GameStatus
- [ ] Services import models from `@/lib/models/`
- [ ] Cascading delete logic present in event-service.ts
- [ ] TypeScript compiles without errors

**Mandatory Patterns** (BigNight.Party):
- Services: No Prisma imports, only models (@docs/constitutions/v1/architecture.md)
- Pattern matching: Use ts-pattern with .exhaustive() (@docs/constitutions/v1/patterns.md)
- No `next/*` imports in services

**Quality Gates**:
```bash
pnpm check-types
pnpm biome check --write src/lib/services/
```

---

## Phase 4: API Layer - Admin Actions

**Strategy**: Sequential
**Reason**: Actions depend on both schemas and services

### Task 4.1: Create Admin Actions

**Files**:
- `src/lib/actions/admin-actions.ts`

**Complexity**: M (3h)

**Dependencies**: Task 2.2 (schemas), Task 3.1 (services)

**Description**:
Create all admin CRUD actions using next-safe-action with adminAction client. Each action validates input with Zod schema, calls service layer, and revalidates paths.

**Implementation Steps**:
1. Import adminAction from `@/lib/actions/safe-action`
2. Import all schemas from `@/schemas/`
3. Import services from `@/lib/services/`
4. Create event actions: createEventAction, updateEventAction, deleteEventAction
5. Create game actions: createGameAction, updateGameAction, deleteGameAction
6. Create category actions: createCategoryAction, updateCategoryAction, deleteCategoryAction
7. Create work actions: createWorkAction, updateWorkAction, deleteWorkAction
8. Create person actions: createPersonAction, updatePersonAction, deletePersonAction
9. Create nomination actions: createNominationAction, updateNominationAction, deleteNominationAction
10. Each action uses `.schema()` with appropriate Zod schema
11. Each action calls appropriate service function in `.action()`
12. Add `revalidatePath('/admin/...')` after mutations
13. Use ts-pattern for complex validation if needed

**Acceptance Criteria**:
- [ ] All 18 CRUD actions implemented (6 entities × 3 operations)
- [ ] All actions use adminAction client
- [ ] All actions use .schema() with Zod validation
- [ ] All mutations call revalidatePath()
- [ ] Actions call service layer (not models directly)
- [ ] TypeScript infers types correctly from schemas
- [ ] TypeScript compiles without errors

**Mandatory Patterns** (BigNight.Party):
- Server actions: MUST use next-safe-action (@docs/constitutions/v1/patterns.md)
- Actions: Call services, not models (@docs/constitutions/v1/architecture.md)
- Validation: Use .schema() with Zod schemas

**Quality Gates**:
```bash
pnpm check-types
pnpm biome check --write src/lib/actions/admin-actions.ts
```

---

## Phase 5: Development Tools - Seed Script

**Strategy**: Sequential
**Reason**: Seed depends on models existing

### Task 5.1: Create Idempotent Seed Script

**Files**:
- `prisma/seed.ts`

**Complexity**: M (2h)

**Dependencies**: Task 2.1 (uses models)

**Description**:
Create idempotent seed script that clears all game data and recreates realistic Oscar 2025 data: 3 works (films), 3 people, 1 event, 1 game, 3 categories, 9 nominations.

**Implementation Steps**:
1. Create `prisma/seed.ts` with main() function
2. Delete existing data in reverse dependency order: Pick → Nomination → Category → Work → Person → Game → Event
3. Create 3 Work records (type: FILM): "Oppenheimer", "Barbie", "Killers of the Flower Moon"
4. Create 3 Person records: "Christopher Nolan", "Greta Gerwig", "Martin Scorsese"
5. Create 1 Event: "97th Academy Awards" (slug: "oscars-2025", eventDate: "2025-03-02")
6. Create 1 Game: "Friends & Family Game" (accessCode: "OSCARS2025", status: SETUP)
7. Create 3 Categories:
   - "Best Picture" (points: 5, order: 1)
   - "Best Director" (points: 3, order: 2)
   - "Best Actor" (points: 2, order: 3)
8. Create 9 Nominations:
   - Best Picture: 3 work-only nominations
   - Best Director: 3 person+work nominations
   - Best Actor: 3 person+work nominations
9. Use realistic nominationText values
10. Add console.log statements for progress
11. Call main().catch() at end

**Acceptance Criteria**:
- [ ] Script runs without errors: `pnpm db:seed`
- [ ] Script is idempotent (can run multiple times)
- [ ] All 3 works created with type FILM
- [ ] All 3 people created
- [ ] Event created with correct slug and date
- [ ] Game created with status SETUP
- [ ] All 9 nominations link correctly to works/people
- [ ] Data visible in Prisma Studio after seed
- [ ] Console logs show progress

**Mandatory Patterns** (BigNight.Party):
- Use Prisma client from `@/lib/db/prisma`
- Delete in reverse dependency order
- Use cuid() for IDs or let Prisma auto-generate

**Quality Gates**:
```bash
pnpm db:seed
pnpm prisma studio  # Verify data exists
pnpm db:seed  # Run again to test idempotency
pnpm biome check --write prisma/seed.ts
```

---

## Phase 6: UI Foundation - Admin Layout

**Strategy**: Sequential
**Reason**: Layout must exist before any admin pages

### Task 6.1: Create Admin Layout and Middleware

**Files**:
- `src/app/(admin)/admin/layout.tsx`

**Complexity**: S (1h)

**Dependencies**: None (uses existing auth)

**Description**:
Create admin layout that checks user authentication and role, redirecting non-admin users to home page. Provides consistent layout for all admin pages.

**Implementation Steps**:
1. Create `src/app/(admin)/admin/layout.tsx` as Server Component
2. Import `auth` from `@/lib/auth/config`
3. Check session exists: `const session = await auth()`
4. Redirect if no session: `redirect('/')`
5. Check admin role: `session.user.role === 'ADMIN'`
6. Redirect non-admins: `redirect('/')`
7. Render admin navigation sidebar with links to all entity pages
8. Render children in main content area
9. Add basic Tailwind styling for sidebar + content layout

**Acceptance Criteria**:
- [ ] Non-authenticated users redirected to /
- [ ] Non-admin users (role: USER) redirected to /
- [ ] Admin users can access layout
- [ ] Navigation sidebar shows all entity links
- [ ] Layout renders children correctly
- [ ] TypeScript compiles without errors

**Mandatory Patterns** (BigNight.Party):
- Server Components for layouts (@docs/constitutions/v1/architecture.md)
- Use existing auth() from Auth.js setup
- Role check uses enum: `session.user.role === 'ADMIN'`

**Quality Gates**:
```bash
pnpm check-types
pnpm biome check --write src/app/\(admin\)/
pnpm dev  # Test redirect behavior
```

---

## Phase 7: Admin UI - CRUD Pages

**Strategy**: Parallel
**Reason**: All admin UI pages are independent and can be built simultaneously

### Task 7.1: Create Events Admin UI

**Files**:
- `src/app/(admin)/admin/events/page.tsx`
- `src/app/(admin)/admin/events/new/page.tsx`
- `src/app/(admin)/admin/events/[id]/page.tsx`

**Complexity**: S (1.5h)

**Dependencies**: Task 4.1 (admin actions), Task 6.1 (layout)

**Description**:
Create CRUD pages for events: list all events, create new event form, view/edit event page with delete button.

**Implementation Steps**:
1. Create `events/page.tsx` - Server Component listing all events in table
2. Fetch events using eventModel.findAll()
3. Display: name, slug, eventDate, category count, game count
4. Add "New Event" button linking to `/admin/events/new`
5. Create `events/new/page.tsx` - Form for creating events
6. Use HTML form with action pointing to createEventAction
7. Fields: name, slug, description, eventDate
8. Create `events/[id]/page.tsx` - View/edit event with categories list
9. Fetch event with eventModel.findById(params.id)
10. Show event details and list of categories
11. Add "Edit" and "Delete" buttons calling updateEventAction/deleteEventAction
12. Add "Add Category" button linking to nested category creation

**Acceptance Criteria**:
- [ ] Events list page renders without errors
- [ ] Create event form submits successfully
- [ ] Event detail page shows event info and categories
- [ ] Edit event updates data correctly
- [ ] Delete event removes event and redirects
- [ ] Form validation errors display
- [ ] revalidatePath called after mutations

**Mandatory Patterns** (BigNight.Party):
- Server Components for data fetching (@docs/constitutions/v1/architecture.md)
- Forms use action attribute (no client state)
- Import actions from `@/lib/actions/admin-actions`

**Quality Gates**:
```bash
pnpm check-types
pnpm biome check --write src/app/\(admin\)/admin/events/
pnpm dev  # Test CRUD operations
```

---

### Task 7.2: Create Games Admin UI

**Files**:
- `src/app/(admin)/admin/games/page.tsx`
- `src/app/(admin)/admin/games/new/page.tsx`
- `src/app/(admin)/admin/games/[id]/page.tsx`

**Complexity**: S (1.5h)

**Dependencies**: Task 4.1 (admin actions), Task 6.1 (layout)

**Description**:
Create CRUD pages for games: list all games, create new game form, view/edit game page with status management.

**Implementation Steps**:
1. Create `games/page.tsx` - List all games with event names
2. Fetch games using gameModel.findAll() with event relation
3. Display: name, event name, accessCode, status, picksLockAt
4. Create `games/new/page.tsx` - Form for creating games
5. Fetch events for dropdown: eventModel.findAll()
6. Fields: name, eventId (dropdown), accessCode, picksLockAt
7. Create `games/[id]/page.tsx` - View/edit game
8. Display current status with dropdown to change (SETUP → OPEN → LIVE → COMPLETED)
9. Show pick count and participant count
10. Add edit and delete buttons

**Acceptance Criteria**:
- [ ] Games list page shows all games with event names
- [ ] Create game form has event dropdown
- [ ] Game detail page shows status and stats
- [ ] Status can be updated via dropdown
- [ ] Delete game cascades to picks
- [ ] TypeScript compiles without errors

**Mandatory Patterns** (BigNight.Party):
- Server Components for data fetching
- Use ts-pattern for GameStatus display if needed
- Forms use action attribute

**Quality Gates**:
```bash
pnpm check-types
pnpm biome check --write src/app/\(admin\)/admin/games/
pnpm dev  # Test CRUD operations
```

---

### Task 7.3: Create Works Admin UI

**Files**:
- `src/app/(admin)/admin/works/page.tsx`
- `src/app/(admin)/admin/works/new/page.tsx`
- `src/app/(admin)/admin/works/[id]/page.tsx`

**Complexity**: S (1.5h)

**Dependencies**: Task 4.1 (admin actions), Task 6.1 (layout)

**Description**:
Create CRUD pages for works: list all works with type filter, create new work form, view/edit work page showing nominations.

**Implementation Steps**:
1. Create `works/page.tsx` - List all works
2. Add filter dropdown for WorkType
3. Display: title, type, year, nomination count
4. Create `works/new/page.tsx` - Form for creating works
5. Fields: title, type (dropdown with all WorkType values), year, posterUrl, externalId
6. Create `works/[id]/page.tsx` - View/edit work
7. Show all nominations this work appears in
8. Add edit and delete buttons
9. Show error if trying to delete work with nominations

**Acceptance Criteria**:
- [ ] Works list page shows all works
- [ ] Type filter works correctly
- [ ] Create form has WorkType dropdown
- [ ] Work detail shows nominations
- [ ] Cannot delete work with nominations (foreign key error handled)
- [ ] Edit work updates successfully

**Mandatory Patterns** (BigNight.Party):
- Use z.nativeEnum for WorkType in forms
- Handle foreign key errors gracefully
- Server Components only

**Quality Gates**:
```bash
pnpm check-types
pnpm biome check --write src/app/\(admin\)/admin/works/
pnpm dev  # Test CRUD operations
```

---

### Task 7.4: Create People Admin UI

**Files**:
- `src/app/(admin)/admin/people/page.tsx`
- `src/app/(admin)/admin/people/new/page.tsx`
- `src/app/(admin)/admin/people/[id]/page.tsx`

**Complexity**: S (1.5h)

**Dependencies**: Task 4.1 (admin actions), Task 6.1 (layout)

**Description**:
Create CRUD pages for people: list all people, create new person form, view/edit person page showing nominations.

**Implementation Steps**:
1. Create `people/page.tsx` - List all people
2. Display: name, imageUrl, nomination count
3. Create `people/new/page.tsx` - Form for creating people
4. Fields: name, imageUrl, externalId
5. Create `people/[id]/page.tsx` - View/edit person
6. Show all nominations this person appears in
7. Add edit and delete buttons
8. Handle foreign key error if trying to delete person with nominations

**Acceptance Criteria**:
- [ ] People list page shows all people
- [ ] Create person form works
- [ ] Person detail shows nominations
- [ ] Cannot delete person with nominations (error handled)
- [ ] Edit person updates successfully
- [ ] TypeScript compiles without errors

**Mandatory Patterns** (BigNight.Party):
- Server Components for data fetching
- Handle foreign key errors gracefully
- Forms use action attribute

**Quality Gates**:
```bash
pnpm check-types
pnpm biome check --write src/app/\(admin\)/admin/people/
pnpm dev  # Test CRUD operations
```

---

### Task 7.5: Create Categories Admin UI

**Files**:
- `src/app/(admin)/admin/events/[id]/categories/new/page.tsx`
- `src/app/(admin)/admin/events/[id]/categories/[categoryId]/page.tsx`

**Complexity**: S (1.5h)

**Dependencies**: Task 4.1 (admin actions), Task 6.1 (layout), Task 7.1 (events UI)

**Description**:
Create CRUD pages for categories nested under events: create new category form, view/edit category page with nominations list.

**Implementation Steps**:
1. Create `categories/new/page.tsx` - Form for creating category within event
2. Get eventId from params.id
3. Fields: name, order, points, isRevealed (checkbox)
4. Create `categories/[categoryId]/page.tsx` - View/edit category
5. Show category details and list of nominations
6. Add "Edit" and "Delete" buttons
7. Add "Add Nomination" button linking to nominations/new
8. Show winner if winnerNominationId is set

**Acceptance Criteria**:
- [ ] Create category form associates with correct event
- [ ] Category list shows under event detail page
- [ ] Category detail shows nominations
- [ ] Edit category updates successfully
- [ ] Delete category works
- [ ] isRevealed checkbox works
- [ ] Winner display works if set

**Mandatory Patterns** (BigNight.Party):
- Nested routes follow Next.js conventions
- Server Components for data fetching
- Forms use action attribute

**Quality Gates**:
```bash
pnpm check-types
pnpm biome check --write src/app/\(admin\)/admin/events/
pnpm dev  # Test CRUD operations
```

---

### Task 7.6: Create Nominations Admin UI

**Files**:
- `src/app/(admin)/admin/events/[id]/categories/[categoryId]/nominations/new/page.tsx`

**Complexity**: S (1.5h)

**Dependencies**: Task 4.1 (admin actions), Task 6.1 (layout), Task 7.3 (works UI), Task 7.4 (people UI), Task 7.5 (categories UI)

**Description**:
Create nomination form nested under categories, allowing selection of work and/or person with validation that at least one is selected.

**Implementation Steps**:
1. Create `nominations/new/page.tsx` - Form for creating nomination
2. Get categoryId from params
3. Fetch all works: workModel.findAll()
4. Fetch all people: personModel.findAll()
5. Fields: nominationText (text), workId (dropdown, optional), personId (dropdown, optional)
6. Add client-side or server-side validation: at least one of workId or personId required
7. Handle validation error if neither selected
8. Show created nominations in category detail page
9. Add delete button for nominations

**Acceptance Criteria**:
- [ ] Nomination form shows work and person dropdowns
- [ ] Validation prevents submitting without work or person
- [ ] Can create work-only nomination
- [ ] Can create person-only nomination
- [ ] Can create work+person nomination
- [ ] Nominations appear in category detail
- [ ] Delete nomination works

**Mandatory Patterns** (BigNight.Party):
- Zod schema validates workId or personId required
- Handle validation errors from server action
- Server Components for data fetching

**Quality Gates**:
```bash
pnpm check-types
pnpm biome check --write src/app/\(admin\)/admin/events/
pnpm dev  # Test validation and CRUD
```

---

### Task 7.7: Create Admin Dashboard Home

**Files**:
- `src/app/(admin)/admin/page.tsx`

**Complexity**: S (1.5h)

**Dependencies**: Task 4.1 (admin actions), Task 6.1 (layout)

**Description**:
Create admin dashboard home page showing overview stats and quick links to all entity management pages.

**Implementation Steps**:
1. Create `admin/page.tsx` - Dashboard overview
2. Fetch counts for all entities:
   - Event count: eventModel.findAll().length
   - Game count: gameModel.findAll().length
   - Category count: categoryModel.findAll().length
   - Work count: workModel.findAll().length
   - Person count: personModel.findAll().length
   - Nomination count: nominationModel.findAll().length
3. Display stats in card grid
4. Add quick links to each entity management page
5. Show recent events and games
6. Add Tailwind styling for dashboard layout

**Acceptance Criteria**:
- [ ] Dashboard shows counts for all entities
- [ ] Quick links navigate to correct pages
- [ ] Recent events displayed
- [ ] Recent games displayed
- [ ] Layout is visually organized
- [ ] TypeScript compiles without errors

**Mandatory Patterns** (BigNight.Party):
- Server Component for data fetching
- Use React cache() for deduplication if needed
- Tailwind v4 for styling

**Quality Gates**:
```bash
pnpm check-types
pnpm biome check --write src/app/\(admin\)/admin/page.tsx
pnpm dev  # Verify dashboard loads
```

---

## Execution Strategy

### Phase Breakdown

1. **Phase 1** (Sequential): Foundation - 3.5h
2. **Phase 2** (Parallel): Data Layer - 3h
3. **Phase 3** (Sequential): Business Logic - 2h
4. **Phase 4** (Sequential): API Layer - 3h
5. **Phase 5** (Sequential): Seed Script - 2h
6. **Phase 6** (Sequential): UI Foundation - 1h
7. **Phase 7** (Parallel): Admin UI - 1.5h (7 tasks in parallel)

### Recommended Execution

**Use `/execute` command:**
```bash
/execute @specs/game-database-admin/plan.md
```

This will:
- Execute phases in order
- Run parallel tasks simultaneously using subagents
- Include code review between tasks
- Verify quality gates pass

### Manual Execution

If executing manually:
1. Complete Phase 1 sequentially
2. Run Phase 2 tasks in parallel (2 developers or 2 terminal sessions)
3. Complete Phases 3-6 sequentially
4. Run Phase 7 tasks in parallel (7 developers or prioritize critical pages)

### Quality Verification

After each phase:
```bash
pnpm lint
pnpm check-types
pnpm dev  # Smoke test
```

After Phase 1:
```bash
pnpm prisma studio  # Verify schema
```

After Phase 5:
```bash
pnpm db:seed  # Verify seed works
```

After Phase 7:
```bash
# Test all admin CRUD operations manually
# Verify non-admin users blocked
# Verify data integrity constraints
```

---

## Success Criteria

**All tasks completed when:**
- [ ] All 15 tasks have acceptance criteria checked
- [ ] `pnpm lint` passes
- [ ] `pnpm check-types` passes
- [ ] `pnpm dev` runs without errors
- [ ] `pnpm db:seed` populates database
- [ ] Admin dashboard accessible at `/admin`
- [ ] All CRUD operations work for all 6 entities
- [ ] Non-admin users redirected from admin routes
- [ ] Data integrity constraints enforced (no duplicate picks, nominations require work or person)
